<% content_for :title, "Transactions" %>

<div class="index-card">
  <div class="index-card-body">
    <div class="index-card-title py-5">Transactions</div>

    <div class="index-card-actions">
      <%= link_to new_expense_path, role: "button", class: "btn-action text-indigo-400 hover:bg-indigo-500 hover:text-white hover:border-indigo-500" do %>
        <%= icon "plus", class: "stroke-3" %>
        New
      <% end %>
    </div>

    <div class="flex flex-col justify-center w-full pt-0 px-1 md:px-3">
      <%= turbo_frame_tag dom_id(Transaction, :list) do %>
        <% cache @page.records do %>
          <% @page.records.group_by(&:due_on).each do |date, transactions| %>
            <%= transactions_date_divider(date) %>

            <%= render partial: "transaction", collection: transactions %>
          <% end %>
        <% end %>
      <% end %>
    </div>

    <div class="flex w-full justify-center align-middle">
      <% if @page.before_last? %>
        <%= turbo_frame_tag dom_id(Transaction, :load_more), class: "loading loading-spinner loading-lg m-auto", src: transactions_path(page: @page.next_param, format: :turbo_stream), loading: :lazy %>
      <% end %>
    </div>
  </div>
</div>
